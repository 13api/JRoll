/*! JRoll v2.0.3 ~ (c) 2015-2016 Author:BarZu Git:https://git.oschina.net/chenjianlong/JRoll2/ Website:http://www.chjtx.com/JRoll/ */
;!function(o,r,l){"use strict";function t(o){for(var l;o!==r&&!("TEXTAREA"===o.tagName&&o.scrollHeight>o.offsetHeight);){if(l=o.getAttribute("jroll-id"))return m[l];o=o.parentNode}return null}function e(o){var r=t(o.target);r?(a.jrollActive=r,r._start(o)):a.jrollActive=null}function s(o){a.jrollActive&&(a.jrollActive.options.preventDefault&&o.preventDefault(),a.jrollActive._move(o))}function n(){a.jrollActive&&a.jrollActive._end()}function i(){setTimeout(function(){for(var o in m)m[o].refresh(),m[o].scrollTo(m[o].x,m[o].y)},600)}var a,c,p="2.0.3",d=o.requestAnimationFrame||o.webkitRequestAnimationFrame||function(o){setTimeout(o,17)},u=r.createElement("div").style,m={};c={TSF:"transform"in u?"transform":"-webkit-transform",TSD:"transitionDuration"in u?"transition-duration":"-webkit-transition-duration",TFO:"transformOrigin"in u?"transform-origin":"-webkit-transform-origin",computePosition:function(o,r){for(var l=0,t=0;o;)l+=o.offsetLeft,t+=o.offsetTop,o=o.offsetParent,o===r&&(o=null);return{left:l,top:t}},moveTo:function(o,r,l,t,e){function s(){u-=17,0>=u?(n=r,i=l):(n=parseInt(n+a,10),i=parseInt(i+p,10)),o.style[c.TSF]="translate("+n+"px, "+i+"px) translateZ(0px) scale("+x+")",u>0&&(n!==r||i!==l)?d(s):"function"==typeof e&&e()}var n,i,a,p,u,m,f=0,_=0,x=1;m=/translate\(([\-\d\.]+)px,\s+([\-\d\.]+)px\)\s+translateZ\(0px\)\s+scale\(([\d\.]+)\)/g.exec(o.style[c.TSF]),m&&(f=Number(m[1]),_=Number(m[2]),x=Number(m[3])),u=t||17,a=(r-f)/(u/17),p=(l-_)/(u/17),n=f,i=_,s()}},r.addEventListener("touchstart",e,!1),r.addEventListener("touchmove",s,!1),r.addEventListener("touchend",n,!1),r.addEventListener("touchcancel",n,!1),o.addEventListener("resize",i,!1),o.addEventListener("orientationchange",i,!1),a=function(o,r){this._init(o,r)},a.version=p,a.utils=c,a.jrollMap=m,a.prototype={_init:function(t,e){var s=this;if(s.wrapper="string"==typeof t?r.querySelector(t):t,s.scroller=e&&e.scroller?"string"==typeof e.scroller?r.querySelector(e.scroller):e.scroller:s.wrapper.children[0],s.scroller.jroll)return s.scroller.jroll.refresh(),s.scroller.jroll;s.scroller.jroll=s,s.wrapperOffset=c.computePosition(s.wrapper,r.body),s.id=e&&e.id||s.scroller.getAttribute("jroll-id")||"jroll_"+l.random().toString().substr(2,8),s.scroller.setAttribute("jroll-id",s.id),m[s.id]=s,s.options={scrollX:!1,scrollY:!0,scrollFree:!1,minX:null,maxX:null,minY:null,maxY:null,zoom:!1,zoomMin:1,zoomMax:4,bounce:!0,scrollBarX:!1,scrollBarY:!1,scrollBarFade:!1,preventDefault:!0,momentum:!0,autoStyle:!0,adjustTop:190};for(var n in e)"scroller"!==n&&(s.options[n]=e[n]);s.options.autoStyle&&("static"===o.getComputedStyle(s.wrapper).position&&(s.wrapper.style.position="relative"),s.wrapper.style.overflow="hidden",s.scroller.style.minHeight="100%"),s.x=0,s.y=0,s.s=null,s.scrollBarX=null,s.scrollBarY=null,s._s={startX:0,startY:0,lastX:0,lastY:0,endX:0,endY:0},s._z={spacing:0,scale:1,startScale:1},s._event={scrollStart:[],scroll:[],scrollEnd:[],zoomStart:[],zoom:[],zoomEnd:[],refresh:[],touchEnd:[]},s.refresh(!0)},enable:function(){var o=this;return o.scroller.setAttribute("jroll-id",o.id),o},disable:function(){var o=this;return o.scroller.removeAttribute("jroll-id"),o},destroy:function(){var o=this;delete m[o.id],delete o.scroller.jroll,o.disable(),o.scroller.style[tSF]="",o.scroller.style[tSD]="",o.prototype=null;for(var r in o)o.hasOwnProperty(r)&&delete o[r]},call:function(o,r){var l=this;return l._s.lockX=!1,l._s.lockY=!1,l.scrollTo(l.x,l.y),a.jrollActive=o,r&&o._start(r),o},refresh:function(o){var r,t,e=this;return e.wrapperWidth=e.wrapper.clientWidth,e.wrapperHeight=e.wrapper.clientHeight,e.scrollerWidth=l.round(e.scroller.offsetWidth*e._z.scale),e.scrollerHeight=l.round(e.scroller.offsetHeight*e._z.scale),e.minScrollX=null===e.options.minX?0:e.options.minX,e.maxScrollX=null===e.options.maxX?e.wrapperWidth-e.scrollerWidth:e.options.maxX,e.minScrollY=null===e.options.minY?0:e.options.minY,e.maxScrollY=null===e.options.maxY?e.wrapperHeight-e.scrollerHeight:e.options.maxY,e.minScrollX<0&&(e.minScrollX=0),e.minScrollY<0&&(e.minScrollY=0),e.maxScrollX>0&&(e.maxScrollX=0),e.maxScrollY>0&&(e.maxScrollY=0),e._s.endX=e.x,e._s.endY=e.y,e.options.scrollBarX?(e.scrollBarX||(r=e._createScrollBar("jroll-xbar","jroll-xbtn",!1),e.scrollBarX=r[0],e.scrollBtnX=r[1]),e.scrollBarScaleX=e.wrapper.clientWidth/e.scrollerWidth,t=l.round(e.scrollBarX.clientWidth*e.scrollBarScaleX),e.scrollBtnX.style.width=(t>8?t:8)+"px"):e.scrollBarX&&(e.wrapper.removeChild(e.scrollBarX),e.scrollBarX=null),e.options.scrollBarY?(e.scrollBarY||(r=e._createScrollBar("jroll-ybar","jroll-ybtn",!0),e.scrollBarY=r[0],e.scrollBtnY=r[1]),e.scrollBarScaleY=e.wrapper.clientHeight/e.scrollerHeight,t=l.round(e.scrollBarY.clientHeight*e.scrollBarScaleY),e.scrollBtnY.style.height=(t>8?t:8)+"px"):e.scrollBarY&&(e.wrapper.removeChild(e.scrollBarY),e.scrollBarY=null),o||e._execEvent("refresh"),e},scale:function(o){var r=this,l=parseFloat(o);return isNaN(l)||(r.scroller.style[c.TFO]="0 0",r._z.scale=l,r.refresh().scrollTo(r.x,r.y,400)),r},_runScrollBarX:function(){var o=this,r=l.round(-1*o.x*o.scrollBarScaleX);o._scrollTo.call({scroller:o.scrollBtnX,_z:{scale:1}},r,0)},_runScrollBarY:function(){var o=this,r=l.round(-1*o.y*o.scrollBarScaleY);o._scrollTo.call({scroller:o.scrollBtnY,_z:{scale:1}},0,r)},_createScrollBar:function(o,l,t){var e,s,n=this;return e=r.createElement("div"),s=r.createElement("div"),e.className=o,s.className=l,this.options.scrollBarX!==!0&&this.options.scrollBarY!==!0||(t?(e.style.cssText="position:absolute;top:2px;right:2px;bottom:2px;width:6px;overflow:hidden;border-radius:2px;-webkit-transform: scaleX(.5);transform: scaleX(.5);",s.style.cssText="background:rgba(0,0,0,.4);position:absolute;top:0;left:0;right:0;border-radius:2px;"):(e.style.cssText="position:absolute;left:2px;bottom:2px;right:2px;height:6px;overflow:hidden;border-radius:2px;-webkit-transform: scaleY(.5);transform: scaleY(.5);",s.style.cssText="background:rgba(0,0,0,.4);height:100%;position:absolute;left:0;top:0;bottom:0;border-radius:2px;")),n.options.scrollBarFade&&(e.style.opacity=0),e.appendChild(s),n.wrapper.appendChild(e),[e,s]},_fade:function(o,r){var l=this;l.fading&&r>0&&(r-=25,r%100===0&&(o.style.opacity=r/1e3),d(l._fade.bind(l,o,r)))},on:function(o,r){var l=this;switch(o){case"scrollStart":l._event.scrollStart.push(r);break;case"scroll":l._event.scroll.push(r);break;case"scrollEnd":l._event.scrollEnd.push(r);break;case"zoomStart":l._event.zoomStart.push(r);break;case"zoom":l._event.zoom.push(r);break;case"zoomEnd":l._event.zoomEnd.push(r);break;case"refresh":l._event.refresh.push(r);break;case"touchEnd":l._event.touchEnd.push(r)}},_execEvent:function(o,r){for(var l=this,t=l._event[o].length-1;t>=0;t--)l._event[o][t].call(l,r)},_compute:function(o,r,t){var e=this;return o>r?e.options.bounce&&o>r+10?l.round(r+(o-r)/4):r:t>o?e.options.bounce&&t-10>o?l.round(t+(o-t)/4):t:o},_scrollTo:function(o,r){this.scroller.style[c.TSF]="translate("+o+"px, "+r+"px) translateZ(0px) scale("+this._z.scale+")"},scrollTo:function(o,r,l,t,e,s){var n=this;return t?(n.x=o,n.y=r):(n.x=o>=n.minScrollX?n.minScrollX:o<=n.maxScrollX?n.maxScrollX:o,n.y=r>=n.minScrollY?n.minScrollY:r<=n.maxScrollY?n.maxScrollY:r),s||(n._s.endX=n.x,n._s.endY=n.y),l?c.moveTo(n.scroller,n.x,n.y,l,e):(n._scrollTo(n.x,n.y),"function"==typeof e&&e()),n.scrollBtnX&&n._runScrollBarX(),n.scrollBtnY&&n._runScrollBarY(),n},_endAction:function(){var o=this;o._s.endX=o.x,o._s.endY=o.y,o.options.scrollBarFade&&!o.fading&&(o.fading=!0,o.scrollBarX&&o._fade(o.scrollBarX,2e3),o.scrollBarY&&o._fade(o.scrollBarY,2e3)),o._execEvent("scrollEnd")},_stepBounce:function(){function o(){r.scrollTo(r.x,r.y,150)}var r=this;r.bouncing=!1,4===r.s?1===r.directionY?(r.scrollTo(r.x,r.minScrollY+30,150,!0,o),r.y=r.minScrollY):(r.scrollTo(r.x,r.maxScrollY-30,150,!0,o),r.y=r.maxScrollY):3===r.s&&(1===r.directionX?(r.scrollTo(r.minScrollX+30,r.y,150,!0,o),r.x=r.minScrollX):(r.scrollTo(r.maxScrollX-30,r.y,150,!0,o),r.x=r.maxScrollX))},_x:function(o){var r=this,l=r.directionX*o;isNaN(l)||(r.x=r.x+l,(r.x>=r.minScrollX||r.x<=r.maxScrollX)&&(r.moving=!1,r.options.bounce&&(r.bouncing=!0)))},_y:function(o){var r=this,l=r.directionY*o;isNaN(l)||(r.y=r.y+l,(r.y>=r.minScrollY||r.y<=r.maxScrollY)&&(r.moving=!1,r.options.bounce&&(r.bouncing=!0)))},_xy:function(o){var r=this,t=l.round(r.cosX*o),e=l.round(r.cosY*o);isNaN(t)||isNaN(e)||(r.x=r.x+t,r.y=r.y+e,(r.x>=r.minScrollX||r.x<=r.maxScrollX)&&(r.y>=r.minScrollY||r.y<=r.maxScrollY)&&(r.moving=!1))},_step:function(o){var r=this,t=Date.now(),e=t-o,s=0;if(r.bouncing&&r._stepBounce(),!r.moving)return void r._endAction();if(e>10){if(r.speed=r.speed-e*(r.speed>1.2?.004:r.speed>.6?.001:6e-4),s=l.round(r.speed*e*2),r.speed<=0||0>=s)return void r._endAction();o=t,r._do(s),r.scrollTo(r.x,r.y,0,!1,null,!0),r._execEvent("scroll")}d(r._step.bind(r,o))},_doScroll:function(r,l){var t,e=this;e.distance=r,e.options.bounce&&(e.x=e._compute(e.x,e.minScrollX,e.maxScrollX),e.y=e._compute(e.y,e.minScrollY,e.maxScrollY)),e.scrollTo(e.x,e.y,0,!!e.options.bounce,null,!0),e._execEvent("scroll",l),l&&l.touches&&(t=l.touches[0].pageY,(10>=t||t>=o.innerHeight-10)&&e._end())},_start:function(o){var r=this,t=o.touches;if(r.count=0,r.moving=!1,(r.options.scrollX||r.options.scrollY||r.options.scrollFree)&&(1===t.length||!r.options.zoom))return r.s=1,r.distance=0,r.startTime=Date.now(),r._s.lastX=r.startPositionX=r._s.startX=t[0].pageX,r._s.lastY=r.startPositionY=r._s.startY=t[0].pageY,void r._execEvent("scrollStart",o);if(r.s=null,r.options.zoom&&t.length>1){r.s=2,r.scroller.style[c.TFO]="0 0";var e=l.abs(t[0].pageX-t[1].pageX),s=l.abs(t[0].pageY-t[1].pageY);return r._z.spacing=l.sqrt(e*e+s*s),r._z.startScale=r._z.scale,r.originX=l.abs(t[0].pageX+t[1].pageX)/2-r.wrapperOffset.left-r.x,r.originY=l.abs(t[0].pageY+t[1].pageY)/2-r.wrapperOffset.top-r.y,void r._execEvent("zoomStart",o)}},_move:function(o){var r,t,e,s,n,i,a,c,p=this,d=o.touches,u=1,m=1;if(p.count++,p.count%2!==0){if(t=d[0].pageX,e=d[0].pageY,s=t-p._s.lastX,n=e-p._s.lastY,i=t-p.startPositionX,a=e-p.startPositionY,p._s.lastX=t,p._s.lastY=e,u=s>=0?1:-1,m=n>=0?1:-1,r=Date.now(),(r-p.startTime>200||p.directionX!==u||p.directionY!==m)&&(p.startTime=r,p.startPositionX=t,p.startPositionY=e,p.directionX=u,p.directionY=m),1===p.s){if(p.options.scrollBarFade&&(p.fading=!1,p.scrollBarX&&(p.scrollBarX.style.opacity=1),p.scrollBarY&&(p.scrollBarY.style.opacity=1)),!p.options.scrollFree&&p.options.scrollY&&(!p.options.scrollX||l.abs(e-p._s.startY)>=l.abs(t-p._s.startX)))return p._do=p._y,void(p.s=4);if(!p.options.scrollFree&&p.options.scrollX&&(!p.options.scrollY||l.abs(e-p._s.startY)<l.abs(t-p._s.startX)))return p._do=p._x,void(p.s=3);if(p.options.scrollFree)return p._do=p._xy,void(p.s=5)}if(4===p.s)return p.y=e-p._s.startY+p._s.endY,void p._doScroll(a,o);if(3===p.s)return p.x=t-p._s.startX+p._s.endX,void p._doScroll(i,o);if(5===p.s)return p.x=t-p._s.startX+p._s.endX,p.y=e-p._s.startY+p._s.endY,c=l.sqrt(i*i+a*a),p.cosX=i/c,p.cosY=a/c,void p._doScroll(l.sqrt(i*i+a*a),o);if(2===p.s){var f,_=l.abs(d[0].pageX-d[1].pageX),x=l.abs(d[0].pageY-d[1].pageY),v=l.sqrt(_*_+x*x),h=v/p._z.spacing*p._z.startScale;return h<p.options.zoomMin?h=p.options.zoomMin:h>p.options.zoomMax&&(h=p.options.zoomMax),f=h/p._z.startScale,p.x=l.round(p.originX-p.originX*f+p._s.endX),p.y=l.round(p.originY-p.originY*f+p._s.endY),p._z.scale=h,p._scrollTo(p.x,p.y),void p._execEvent("zoom",o)}}},_end:function(){var o,r,t=this,e=Date.now(),s=4===t.s,n=3===t.s,i=5===t.s;return a.jrollActive=null,t._execEvent("touchEnd"),s||n||i?(t.duration=e-t.startTime,o=t.y>t.minScrollY||t.y<t.maxScrollY,r=t.x>t.minScrollX||t.x<t.maxScrollX,void(s&&o||n&&r||i&&(o||r)?t.scrollTo(t.x,t.y,300)._endAction():t.options.momentum&&t.duration>10&&t.duration<200?(t.speed=l.abs(t.distance/t.duration),t.speed=t.speed>3?3:t.speed,t.moving=!0,d(t._step.bind(t,e))):t._endAction())):2===t.s?(t._z.scale>t.options.zoomMax?t._z.scale=t.options.zoomMax:t._z.scale<t.options.zoomMin&&(t._z.scale=t.options.zoomMin),t.refresh(),t.scrollTo(t.x,t.y,400),void t._execEvent("zoomEnd")):void(1!==t.s&&2!==t.s||!t.options.scrollBarFade||t.fading||(t.fading=!0,t.scrollBarX&&t._fade(t.scrollBarX,2e3),t.scrollBarY&&t._fade(t.scrollBarY,2e3)))}},"undefined"!=typeof module&&module.exports&&(module.exports=a),"function"==typeof define&&define(function(){return a}),o.JRoll=a}(window,document,Math);